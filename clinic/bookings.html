<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Your Appointment</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
    <header>
        <img src="clinic/logo.png" alt="Clinic Logo" class="logo">
        <h1>Onestop AI Clinic Demo</h1>
        <button id="themeToggle">Toggle Theme</button>
    </header>

    <main>
        <div class="hero-banner">
            <img src="assets/clinic-hero-banner.png" alt="Clinic Hero Banner">
        </div>

        <h2>Book Your Appointment</h2>

        <form id="bookingForm">
            <label for="date">ðŸ“… Select Date</label>
            <select id="date" required>
                <option value="">Select date</option>
            </select>

            <label for="time">ðŸ•’ Select Time Slot</label>
            <select id="time" required>
                <option value="">Select a date first</option>
            </select>

            <label for="name">ðŸ‘¤ Patient Name</label>
            <input type="text" id="name" placeholder="Enter your name" required>

            <label for="reason">ðŸ©º Reason for Visit</label>
            <input type="text" id="reason" placeholder="E.g., Fever, Headache..." required>

            <button type="submit" class="btn-primary">Book on WhatsApp</button>
        </form>
    </main>

    <footer>
        <p>Powered by Onestop AI</p>
    </footer>

    <script>
        const themeToggle = document.getElementById('themeToggle');
        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            localStorage.setItem('theme', document.body.classList.contains('dark-theme') ? 'dark' : 'light');
        });

        window.onload = () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') document.body.classList.add('dark-theme');

            // Load Dates
            fetch('slots.csv')
                .then(response => response.text())
                .then(data => {
                    const lines = data.split('\n').slice(1);
                    const dates = [...new Set(lines.map(line => line.split(',')[0]))];
                    const dateSelect = document.getElementById('date');
                    dates.forEach(date => {
                        if (date.trim()) {
                            const option = document.createElement('option');
                            option.value = date;
                            option.textContent = date;
                            dateSelect.appendChild(option);
                        }
                    });
                });

            document.getElementById('date').addEventListener('change', function() {
                const selectedDate = this.value;
                fetch('slots.csv')
                    .then(response => response.text())
                    .then(data => {
                        const lines = data.split('\n').slice(1);
                        const timeSelect = document.getElementById('time');
                        timeSelect.innerHTML = '<option value="">Select a time slot</option>';
                        lines.forEach(line => {
                            const [date, time, status] = line.split(',');
                            if (date === selectedDate && status.trim() === 'Available') {
                                const option = document.createElement('option');
                                option.value = time;
                                option.textContent = time;
                                timeSelect.appendChild(option);
                            }
                        });
                    });
            });
        };

        document.getElementById('bookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const name = document.getElementById('name').value;
            const reason = document.getElementById('reason').value;

            const message = `Booking Request:\nDate: ${date}\nTime: ${time}\nName: ${name}\nReason: ${reason}`;
            const whatsappURL = `https://wa.me/919390664577?text=${encodeURIComponent(message)}`;
            window.open(whatsappURL, '_blank');
        });
    </script>
</body>
</html>
