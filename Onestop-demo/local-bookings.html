<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Local Bookings - Onestop C-Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles.css">
<style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f8f9fa; }
    h1 { text-align: center; margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 14px; }
    th { background: #333; color: #fff; }
    button { padding: 8px 12px; margin: 5px; border: none; cursor: pointer; border-radius: 4px; }
    .btn-export { background: #28a745; color: white; }
    .btn-clear { background: #dc3545; color: white; }
    .btn-delete { background: #ff4444; color: white; font-size: 12px; padding: 4px 8px; }
</style>
</head>
<body>

<h1>ðŸ“‹ Local Bookings</h1>
<div style="text-align:center;">
    <button class="btn-export" onclick="exportCSV()">Export CSV</button>
    <button class="btn-clear" onclick="clearBookings()">Clear All</button>
</div>

<table id="bookingsTable">
    <thead>
        <tr>
            <th>#</th>
            <th>Date</th>
            <th>Time Slot</th>
            <th>Patient Name</th>
            <th>Reason</th>
            <th>Contact</th>
            <th>Token</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
function loadBookings() {
    let bookings = JSON.parse(localStorage.getItem("localBookings") || "[]");
    let tbody = document.querySelector("#bookingsTable tbody");
    tbody.innerHTML = "";
    bookings.forEach((b, index) => {
        let row = `<tr>
            <td>${index+1}</td>
            <td>${b.date || ""}</td>
            <td>${b.slot || ""}</td>
            <td>${b.name || ""}</td>
            <td>${b.reason || ""}</td>
            <td>${b.contact || ""}</td>
            <td>${b.token || ""}</td>
            <td><button class="btn-delete" onclick="deleteBooking(${index})">Delete</button></td>
        </tr>`;
        tbody.innerHTML += row;
    });
}

function deleteBooking(index) {
    let bookings = JSON.parse(localStorage.getItem("localBookings") || "[]");
    bookings.splice(index, 1);
    localStorage.setItem("localBookings", JSON.stringify(bookings));
    loadBookings();
}

function clearBookings() {
    if(confirm("Are you sure you want to clear all bookings?")) {
        localStorage.removeItem("localBookings");
        loadBookings();
    }
}

function exportCSV() {
    let bookings = JSON.parse(localStorage.getItem("localBookings") || "[]");
    if(bookings.length === 0) {
        alert("No bookings to export.");
        return;
    }
    let csv = "Date,Time Slot,Patient Name,Reason,Contact,Token\n";
    bookings.forEach(b => {
        csv += `${b.date || ""},${b.slot || ""},${b.name || ""},${b.reason || ""},${b.contact || ""},${b.token || ""}\n`;
    });
    let blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
    let link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "local-bookings.csv";
    link.click();
}

loadBookings();
</script>

</body>
</html>
