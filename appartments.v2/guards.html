<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Apartments â€¢ Guards</title>
<link rel="stylesheet" href="./styles.css">
<meta name="theme-color" content="#111"/>
</head><body class="bg">
<button class="logout" onclick="sessionStorage.clear();location.href='./index.html'">Logout</button>

<main class="wrap">
  <div class="card hero">
    <img class="banner" src="./assets/apartments_banner.png" alt="Apartments">
    <div class="hero-overlay">
      <img class="logo" src="./assets/logo.png" onerror="this.style.display='none'">
      <div class="hero-title" data-i18n="guards_title">Guard Console</div>
      <div class="chips">
        <button class="chip round" id="themeChip">ðŸŒ™</button>
        <button class="chip round" data-lang="en">EN</button>
        <button class="chip round" data-lang="te">TE</button>
      </div>
    </div>
  </div>

  <!-- NAV TABS (so forms donâ€™t stack) -->
  <div class="card mt">
    <div class="tabs">
      <button class="tab" data-tab="pre" data-i18n="preapproved_visitors">Pre-Approved Visitors</button>
      <button class="tab" data-tab="walk" data-i18n="walkin_visitor">Walk-in Visitor</button>
      <button class="tab" data-tab="del" data-i18n="deliveries_title">Deliveries</button>
      <button class="tab" data-tab="hist" data-i18n="visitor_history_today">Visitor History (Today)</button>
    </div>
  </div>

  <!-- Pre-approvals -->
  <section class="card mt tabpanel" data-tab="pre">
    <div class="row space">
      <h2 class="h2" data-i18n="preapproved_visitors">Pre-Approved Visitors</h2>
      <input id="pa_search" class="in" placeholder="Search name/flat/purpose">
    </div>
    <p class="muted" data-i18n="preapproved_note">From residentsâ€™ pre-approvals. Verify ID â†’ tap Check-In.</p>
    <div class="tablewrap">
      <table class="tbl"><thead><tr>
        <th>#</th><th data-i18n="flat">Flat</th><th data-i18n="name">Name</th>
        <th data-i18n="date">Date</th><th data-i18n="purpose">Purpose</th><th data-i18n="action">Action</th>
      </tr></thead><tbody id="pa_tbody"></tbody></table>
      <div id="pa_empty" class="muted" data-i18n="no_preapprovals">No pre-approvals found.</div>
    </div>
  </section>

  <!-- Walk-in -->
  <section class="card mt tabpanel" data-tab="walk">
    <h2 class="h2" data-i18n="walkin_visitor">Walk-in Visitor</h2>
    <div class="grid2">
      <label data-i18n="flat_unit">Flat / Unit<input id="w_flat" class="in" placeholder="e.g., A-302"></label>
      <label data-i18n="name">Name<input id="w_name" class="in" placeholder="Visitor name"></label>
      <label data-i18n="phone">Phone<input id="w_phone" class="in" inputmode="numeric" maxlength="10" placeholder="optional"></label>
      <label data-i18n="purpose">Purpose<input id="w_purpose" class="in" placeholder="guest/maintenance"></label>
    </div>
    <div class="cam mt8">
      <div><video id="cam" playsinline autoplay muted></video><canvas id="snap" style="display:none"></canvas></div>
      <div>
        <button class="btn" id="cam_start" data-i18n="open_camera">Open Camera</button>
        <button class="btn mt8" id="cam_capture" data-i18n="capture_photo">Capture Photo</button>
        <img id="preview" class="snap" alt="Snapshot" style="display:none"/>
      </div>
    </div>
    <div class="row mt8">
      <button class="btn" id="w_checkin" data-i18n="checkin">Check-In</button>
      <button class="btn secondary" id="w_clear" data-i18n="clear">Clear</button>
    </div>
  </section>

  <!-- Deliveries -->
  <section class="card mt tabpanel" data-tab="del">
    <h2 class="h2" data-i18n="deliveries_title">Couriers / Deliveries</h2>
    <div class="grid2">
      <label data-i18n="flat_unit">Flat / Unit<input id="d_flat" class="in" placeholder="A-302"></label>
      <label data-i18n="from_courier">From / Courier<input id="d_from" class="in" placeholder="Amazon / Swiggy"></label>
    </div>
    <div class="cam mt8">
      <div><video id="cam2" playsinline autoplay muted></video><canvas id="snap2" style="display:none"></canvas></div>
      <div>
        <button class="btn" id="cam2_start" data-i18n="open_camera">Open Camera</button>
        <button class="btn mt8" id="cam2_capture" data-i18n="capture_parcel">Capture Parcel</button>
        <img id="preview2" class="snap" alt="Parcel" style="display:none"/>
      </div>
    </div>
    <div class="row mt8">
      <button class="btn" id="d_add" data-i18n="add_delivery">Add Delivery</button>
      <button class="btn secondary" id="d_export" data-i18n="export_csv">Export Deliveries CSV</button>
    </div>
    <div class="tablewrap">
      <table class="tbl"><thead><tr>
        <th>#</th><th data-i18n="flat">Flat</th><th data-i18n="from">From</th>
        <th data-i18n="time">Time</th><th data-i18n="photo">Photo</th>
        <th data-i18n="status">Status</th><th data-i18n="action">Action</th>
      </tr></thead><tbody id="d_tbody"></tbody></table>
      <div id="d_empty" class="muted" data-i18n="no_deliveries">No deliveries yet.</div>
    </div>
  </section>

  <!-- History -->
  <section class="card mt tabpanel" data-tab="hist">
    <div class="row space">
      <h2 class="h2" data-i18n="visitor_history_today">Visitor History (Today)</h2>
      <div class="row">
        <input id="vh_search" class="in" placeholder="Search name/flat/purpose" style="max-width:260px">
        <button class="btn secondary" id="vh_export" data-i18n="export_csv">Export Visitors CSV</button>
      </div>
    </div>
    <div class="tablewrap">
      <table class="tbl"><thead><tr>
        <th>#</th><th data-i18n="flat">Flat</th><th data-i18n="name">Name</th>
        <th data-i18n="purpose">Purpose</th><th data-i18n="time">Time</th><th data-i18n="photo">Photo</th>
      </tr></thead><tbody id="vh_tbody"></tbody></table>
      <div id="vh_empty" class="muted" data-i18n="no_visitors_today">No visitors checked in today.</div>
    </div>
  </section>
</main>

<script src="./lang.js"></script>
<script>
/* theme/lang/tabs glue (same as residents) */
const LS_THEME='apt_theme', LS_LANG='apt_lang', PAGE_KEY='guards';
function applyTheme(){const t=localStorage.getItem(LS_THEME)||'light';document.documentElement.setAttribute('data-theme',t);document.getElementById('themeChip').textContent=t==='light'?'ðŸŒ™':'ðŸŒž';}
function toggleTheme(){localStorage.setItem(LS_THEME,(localStorage.getItem(LS_THEME)||'light')==='light'?'dark':'light');applyTheme();}
function applyLang(){document.querySelectorAll('[data-i18n]').forEach(el=>{const k=el.getAttribute('data-i18n'); if(window.t){el.firstChild.nodeValue=t(k);}});}
document.addEventListener('click',e=>{ if(e.target.id==='themeChip') toggleTheme(); if(e.target.dataset.lang){localStorage.setItem(LS_LANG,e.target.dataset.lang); location.reload();}});
function setupTabs(){const tabs=document.querySelectorAll('.tab');const panels=document.querySelectorAll('.tabpanel');const KEY=PAGE_KEY+'_tab';function show(id){tabs.forEach(b=>b.classList.toggle('active',b.dataset.tab===id));panels.forEach(p=>p.style.display=p.dataset.tab===id?'block':'none');localStorage.setItem(KEY,id);}tabs.forEach(b=>b.addEventListener('click',()=>show(b.dataset.tab)));show(localStorage.getItem(KEY)||tabs[0].dataset.tab);}
applyTheme();applyLang();setupTabs();
</script>

<!-- Keep your existing guards JS below if needed (check-in, camera, storageâ€¦). -->
</body></html>
