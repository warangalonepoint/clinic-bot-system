<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Teacher · School Demo</title>
  <link rel="stylesheet" href="styles.css">
<script type="module" src="ui.js"></script>
</head>
<body class="dark">
  <div class="wrapper">
    <section class="accent-indigo">
      <div class="glass header">
        <div class="row" style="justify-content:space-between;align-items:center;">
          <div class="h1">Teacher</div>
          <div class="row">
            <a class="btn" href="index.html">PIN</a>
            <button class="btn btn-gradient" onclick="toggleTheme()">Theme</button>
          </div>
        </div>
        <div class="text-dim">Post diary & homework · mark attendance</div>
      </div>
    </section>

    <div class="tabs mt-16">
      <div class="tab-list">
        <button class="tab-btn" data-tab="t-setup" aria-selected="true">Class Setup</button>
        <button class="tab-btn" data-tab="t-diary">Class Diary</button>
        <button class="tab-btn" data-tab="t-hw">Homework</button>
        <button class="tab-btn" data-tab="t-att">Attendance</button>
      </div>
    </div>

    <div class="tab-panels">
      <!-- Setup -->
      <div class="tab-panel active" id="t-setup">
        <section class="accent-violet">
          <div class="glass">
            <div class="h2">My Class</div>
            <div class="grid cols-2">
              <input id="tc-class" class="input" placeholder="Class e.g., 5">
              <input id="tc-sec" class="input" placeholder="Section e.g., A">
              <input id="tc-name" class="input" placeholder="Your Name">
              <input id="tc-subj" class="input" placeholder="Subject e.g., Maths">
            </div>
            <div class="mt-12"><button class="btn btn-indigo" id="tcSave">Save</button></div>
            <div id="tcMsg" class="text-dim mt-12"></div>
          </div>
        </section>
      </div>

      <!-- Diary -->
      <div class="tab-panel" id="t-diary">
        <section class="accent-rose">
          <div class="glass">
            <div class="h2">Post to Class Diary</div>
            <div class="grid cols-2">
              <input type="date" id="td-date" class="input">
              <input id="td-subj" class="input" placeholder="Subject">
            </div>
            <textarea id="td-note" class="input mt-12" placeholder="What was taught / notes..."></textarea>
            <div class="mt-12">
              <button class="btn btn-rose" id="tdPost">Publish</button>
            </div>
            <div class="h2 mt-16">Recent</div>
            <div id="td-list" class="mt-12"></div>
          </div>
        </section>
      </div>

      <!-- Homework -->
      <div class="tab-panel" id="t-hw">
        <section class="accent-indigo">
          <div class="glass">
            <div class="h2">Create Homework</div>
            <div class="grid cols-2">
              <input type="date" id="hw-due" class="input">
              <input id="hw-subj" class="input" placeholder="Subject">
            </div>
            <input id="hw-title" class="input mt-12" placeholder="Title e.g., Exercise 5A">
            <textarea id="hw-details" class="input mt-12" placeholder="Details..."></textarea>
            <div class="mt-12"><button class="btn btn-indigo" id="hwAdd">Publish</button></div>
            <div class="h2 mt-16">Recent</div>
            <div id="hw-list" class="mt-12"></div>
          </div>
        </section>
      </div>

      <!-- Attendance -->
      <div class="tab-panel" id="t-att">
        <section class="accent-teal">
          <div class="glass">
            <div class="h2">Attendance (demo)</div>
            <div class="text-dim">Tap to toggle P/A. Stored locally.</div>
            <div id="att-wrap" class="grid cols-3 mt-12"></div>
            <div class="mt-12"><button class="btn btn-teal" id="attSave">Save</button></div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script type="module" src="ui.js"></script>
  <script>
  const db = {
    get(k,def){ try{ return JSON.parse(localStorage.getItem(k)) ?? def; }catch{ return def; } },
    set(k,v){ localStorage.setItem(k, JSON.stringify(v)); }
  };

  // Setup
  const profileKey = 'teacherProfile';
  function loadProfile(){
    const p = db.get(profileKey,{cls:'',sec:'',name:'',sub:''});
    document.getElementById('tc-class').value = p.cls;
    document.getElementById('tc-sec').value = p.sec;
    document.getElementById('tc-name').value = p.name;
    document.getElementById('tc-subj').value = p.sub;
  }
  document.getElementById('tcSave').addEventListener('click', ()=>{
    const p = {
      cls: document.getElementById('tc-class').value.trim(),
      sec: document.getElementById('tc-sec').value.trim(),
      name: document.getElementById('tc-name').value.trim(),
      sub: document.getElementById('tc-subj').value.trim()
    };
    db.set(profileKey,p);
    document.getElementById('tcMsg').textContent = 'Saved locally.';
  });
  loadProfile();

  // Diary
  const diaryKey = 'diary';
  function renderDiary(){
    const arr = db.get(diaryKey,[]);
    document.getElementById('td-list').innerHTML =
      arr.slice(-10).reverse().map(d=>`<div class="glass"><b>${d.subject}</b> · <span class="text-dim">${d.date}</span><div class="mt-8">${d.note}</div></div>`).join('') || '<div class="text-dim">No entries.</div>';
  }
  document.getElementById('tdPost').addEventListener('click', ()=>{
    const date = document.getElementById('td-date').value || new Date().toISOString().slice(0,10);
    const subject = document.getElementById('td-subj').value || db.get(profileKey,{}).sub || 'General';
    const note = (document.getElementById('td-note').value||'').trim();
    if(!note) return;
    const arr = db.get(diaryKey,[]); arr.push({date,subject,note}); db.set(diaryKey,arr);
    document.getElementById('td-note').value=''; renderDiary();
  });
  renderDiary();

  // Homework
  const hwKey='homework';
  function renderHW(){
    const arr = db.get(hwKey,[]);
    document.getElementById('hw-list').innerHTML =
      arr.slice(-10).reverse().map(h=>`<div class="glass"><b>${h.subject}</b> · <span class="text-dim">Due ${h.due}</span><div class="mt-8">${h.title} — ${h.details}</div></div>`).join('') || '<div class="text-dim">No homework.</div>';
  }
  document.getElementById('hwAdd').addEventListener('click', ()=>{
    const due = document.getElementById('hw-due').value || new Date(Date.now()+86400000).toISOString().slice(0,10);
    const subject = document.getElementById('hw-subj').value || db.get(profileKey,{}).sub || 'General';
    const title = document.getElementById('hw-title').value || 'Homework';
    const details = document.getElementById('hw-details').value || '';
    const arr = db.get(hwKey,[]); arr.push({due,subject,title,details}); db.set(hwKey,arr);
    renderHW();
  });
  renderHW();

  // Attendance demo
  function renderAtt(){
    const names = db.get('studentsDemo',['Aarav','Isha','Kabir','Mira','Rohan','Zara','Veer','Anaya','Dev','Ira','Sai','Tara']);
    const state = db.get('attState', {});
    const wrap = document.getElementById('att-wrap');
    wrap.innerHTML = '';
    names.forEach((n,i)=>{
      const btn = document.createElement('button');
      btn.className='btn';
      btn.textContent = (state[n]?'P':'A')+' · '+n;
      btn.style.width='100%';
      btn.onclick = ()=>{ state[n] = !state[n]; btn.textContent=(state[n]?'P':'A')+' · '+n; };
      wrap.appendChild(btn);
    });
    document.getElementById('attSave').onclick = ()=>{ db.set('attState', state); };
  }
  renderAtt();
  </script>
</body>
</html>
