<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Clinic • PIN</title>
<link rel="manifest" href="./manifest.webmanifest">
<link rel="stylesheet" href="./styles.css">
<meta name="theme-color" content="#111"/>
<style>
  main{max-width:720px;margin:16px auto;padding:16px}
  .card{background:#fff;border-radius:18px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.08)}
  /* Polished banner/header */
  .hero{position:relative;padding:0;overflow:hidden;border-radius:18px}
  .banner{width:100%;height:180px;object-fit:cover;display:block}
  @media(max-width:560px){.banner{height:140px}}
  .hero-overlay{position:absolute;inset:0;display:flex;align-items:flex-end;padding:14px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.38))}
  .logo{position:absolute;top:12px;left:12px;width:56px;height:56px;border-radius:999px;background:#fff;padding:8px;box-shadow:0 6px 20px rgba(0,0,0,.18)}
  .hero-title{margin-left:80px;margin-bottom:6px;font-weight:800;font-size:20px;color:#fff;text-shadow:0 1px 2px rgba(0,0,0,.35)}
  .hero,.logo,.hero-title{animation:fade .35s ease-out both}
  @keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

  /* Quick links: black buttons, two per row */
  .ql-2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media(max-width:360px){.ql-2{grid-template-columns:1fr 1fr}}
  .btn{padding:12px 16px;border:0;border-radius:12px;font-weight:700;background:#111;color:#fff;text-align:center;text-decoration:none}
  .iconbtn{display:flex;align-items:center;justify-content:center;gap:10px}
  .iconbtn img{width:22px;height:22px;border-radius:6px}

  input{width:100%;padding:12px;border:1px solid #ddd;border-radius:12px;font-size:15px}
  .muted{color:#666}
</style>
</head><body>
<main>
  <!-- Polished banner -->
  <div class="card hero">
    <img class="banner" src="./assets/clinic_banner.png" alt="Clinic">
    <div class="hero-overlay">
      <img class="logo" src="./assets/logo.png" onerror="this.src='./assets/admin.png'">
      <div class="hero-title">Onestop Clinic</div>
    </div>
  </div>

  <div class="card" style="margin-top:12px">
    <h2 style="margin:0 0 6px">Enter PIN</h2>
    <p class="muted" style="margin-bottom:8px">You’ll be routed automatically.</p>
    <form id="pinForm">
      <input id="pin" type="password" inputmode="numeric" autocomplete="one-time-code" placeholder="4–8 digit PIN">
      <button class="btn" style="margin-top:10px;width:100%">Continue</button>
    </form>
    <div id="msg" class="muted" style="margin-top:8px"></div>
  </div>

  <div class="card" style="margin-top:12px">
    <h3 style="margin:0 0 8px">Quick Access</h3>
    <div class="ql-2">
      <a class="btn iconbtn" href="./booking.html"><img src="./assets/booking.png" onerror="this.style.display='none'">Booking Bot</a>
      <a class="btn iconbtn" href="./admin.html"><img src="./assets/admin.png" onerror="this.style.display='none'">Admin</a>
      <a class="btn iconbtn" href="./doctor.html"><img src="./assets/doctor.png" onerror="this.style.display='none'">Doctor/Manager</a>
      <a class="btn iconbtn" href="./reset.html"><img src="./assets/reset.png" onerror="this.style.display='none'">Reset Cache</a>
    </div>
  </div>
</main>

<script>
// Map role → page
const rolePage={doctor:"./doctor.html", admin:"./admin.html"};
async function loadPins(){const r=await fetch("./pins.json",{cache:"no-store"});if(!r.ok)throw 0;return r.json();}
document.getElementById("pinForm").addEventListener("submit", async (e)=>{
  e.preventDefault();
  const pin=document.getElementById("pin").value.trim(); const msg=document.getElementById("msg");
  msg.textContent="Checking…";
  try{
    const pins=await loadPins(); let matched=null;
    for(const [role,val] of Object.entries(pins)){ if(String(val)===pin){ matched=role; break; } }
    if(!matched){ msg.textContent="Invalid PIN."; return; }
    sessionStorage.setItem("clinic_role",matched);
    sessionStorage.setItem("clinic_login_at",String(Date.now()));
    location.replace(rolePage[matched]||"./index.html");
  }catch{ msg.textContent="Error loading PINs."; }
});
if("serviceWorker" in navigator){navigator.serviceWorker.register("./sw.js").catch(()=>{});}
</script>
</body></html>
