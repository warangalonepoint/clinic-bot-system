<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assign Clinics Tool</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f0f0f;
      color: #fff;
      padding: 20px;
    }
    h1 {
      color: #4dc1ff;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      padding: 12px;
      border: 1px solid #444;
      text-align: left;
    }
    th {
      background-color: #222;
    }
    input, select {
      padding: 8px;
      width: 100%;
      background: #1c1c1c;
      color: white;
      border: 1px solid #555;
    }
    button {
      padding: 10px 20px;
      background: #28a745;
      color: white;
      border: none;
      cursor: pointer;
    }
    .danger {
      background-color: #dc3545;
    }
  </style>
</head>
<body>
  <h1>Assign Clinics Tool (Admin Only)</h1>  <table id="clinicTable">
    <thead>
      <tr>
        <th>PIN</th>
        <th>Clinic Name</th>
        <th>Plan</th>
        <th>Override Lock</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>  <br>
  <button onclick="addClinicRow()">‚ûï Add New Clinic Row</button>
  <button onclick="saveJSON()">üíæ Save plans.json</button>  <script>
    const plansPath = 'https://warangalonepoint.github.io/clinic-bot-system/plans.json';
    let plans = {};

    async function loadPlans() {
      const res = await fetch(plansPath);
      plans = await res.json();
      const tbody = document.querySelector("#clinicTable tbody");
      tbody.innerHTML = '';
      Object.entries(plans).forEach(([pin, details]) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><input value="${pin}" data-original="${pin}" /></td>
          <td><input value="${details.clinic || ''}" /></td>
          <td>
            <select>
              <option value="free" ${details.plan === 'free' ? 'selected' : ''}>Free</option>
              <option value="paid" ${details.plan === 'paid' ? 'selected' : ''}>Paid</option>
              <option value="premium" ${details.plan === 'premium' ? 'selected' : ''}>Premium</option>
            </select>
          </td>
          <td>
            <select>
              <option value="true" ${details.overrideLock ? 'selected' : ''}>true</option>
              <option value="false" ${!details.overrideLock ? 'selected' : ''}>false</option>
            </select>
          </td>
          <td><button class="danger" onclick="deleteClinicRow(this)">üóëÔ∏è Delete</button></td>
        `;
        tbody.appendChild(tr);
      });
    }

    function addClinicRow() {
      const tbody = document.querySelector("#clinicTable tbody");
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input /></td>
        <td><input /></td>
        <td>
          <select>
            <option value="free">Free</option>
            <option value="paid">Paid</option>
            <option value="premium">Premium</option>
          </select>
        </td>
        <td>
          <select>
            <option value="true">true</option>
            <option value="false">false</option>
          </select>
        </td>
        <td><button class="danger" onclick="deleteClinicRow(this)">üóëÔ∏è Delete</button></td>
      `;
      tbody.appendChild(tr);
    }

    function deleteClinicRow(btn) {
      const tr = btn.closest("tr");
      tr.remove();
    }

    function saveJSON() {
      const rows = document.querySelectorAll("#clinicTable tbody tr");
      const newPlans = {};
      for (let row of rows) {
        const inputs = row.querySelectorAll("input, select");
        const pin = inputs[0].value.trim();
        if (!pin) continue;
        newPlans[pin] = {
          clinic: inputs[1].value.trim(),
          plan: inputs[2].value.trim(),
          overrideLock: inputs[3].value === 'true'
        };
      }
      const blob = new Blob([JSON.stringify(newPlans, null, 2)], { type: 'application/json' });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "plans.json";
      a.click();
    }

    loadPlans();
  </script></body>
</html>
