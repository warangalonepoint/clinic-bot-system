<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Booking Confirmation</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 40px;
    }
    .box {
      background: #222;
      padding: 20px;
      border-radius: 12px;
      max-width: 400px;
      margin: 0 auto;
    }
    h1 {
      color: #0f0;
    }
    .token {
      font-size: 24px;
      margin-top: 10px;
      color: #0ff;
    }
  </style>
</head>
<body>
  <div class="box">
    <h1>âœ… Appointment Confirmed!</h1>
    <p id="name"></p>
    <p id="date"></p>
    <p id="time"></p>
    <p id="reason"></p>
    <p class="token" id="token"></p>
  </div>  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get("name") || "-";
    const date = urlParams.get("date") || "-";
    const time = urlParams.get("time") || "-";
    const reason = urlParams.get("reason") || "-";
    const contact = urlParams.get("contact") || "-";

    document.getElementById("name").textContent = `ðŸ‘¤ Name: ${name}`;
    document.getElementById("date").textContent = `ðŸ“… Date: ${date}`;
    document.getElementById("time").textContent = `â° Time: ${time}`;
    document.getElementById("reason").textContent = `ðŸ“„ Reason: ${reason}`;

    const logsURL = "https://warangalonepoint.github.io/clinic-bot-system/clinic/logs.csv";

    async function assignTokenAndSave() {
      let token = 1;
      try {
        const res = await fetch(logsURL);
        const text = await res.text();
        const lines = text.trim().split("\n");
        const todayCount = lines.filter(line => line.startsWith(date + ",")).length;
        token = todayCount + 1;
      } catch (e) {
        console.warn("Token fetch error", e);
      }

      document.getElementById("token").textContent = `ðŸŽ« Token No: ${token}`;

      // Save to logs.csv (via backend/API/manual setup)
      const newRow = `${date},${time},${name},${reason},${contact},${token},No`;
      console.log("ðŸ“¥ Save row:", newRow);

      // Optional: Post to endpoint or instruct manual append
    }

    assignTokenAndSave();
  </script></body>
</html>
