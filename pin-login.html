<script>
  async function validatePIN() {
    const enteredPIN = document.getElementById("pinInput").value.trim();
    const plansURL = "https://warangalonepoint.github.io/clinic-bot-system/plans.json";

    try {
      const res = await fetch(plansURL);
      const plans = await res.json();

      const match = plans.find(item => item.pin === enteredPIN);

      if (!match) {
        alert("❌ Invalid PIN. Please try again.");
        return;
      }

      const { clinicID, plan } = match;

      // Save to localStorage
      localStorage.setItem("clinicID", clinicID);
      localStorage.setItem("pricingPlan", plan);

      // Redirect to dashboard
      window.location.href = "dashboard.html";
    } catch (err) {
      console.error("Error fetching plans:", err);
      alert("⚠️ Could not load plan data. Try again.");
    }
  }
</script>
