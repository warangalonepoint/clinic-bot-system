<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Staff Leave Tracker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-4">
  <div class="container">
    <h2 class="mb-4">📆 Staff Leave Tracker</h2><div class="mb-3">
  <input type="text" id="searchInput" class="form-control" placeholder="Search by name, ID, or date...">
</div>

<table class="table table-bordered table-hover" id="leaveTable">
  <thead class="table-dark">
    <tr>
      <th>Date</th>
      <th>Employee ID</th>
      <th>Name</th>
      <th>Leave Type</th>
      <th>Reason</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<button class="btn btn-primary" onclick="exportCSV()">⬇️ Export Leave Data</button>

  </div>  <script>
    let allRows = [];

    fetch('./staff-leaves.csv')
      .then(res => res.text())
      .then(data => {
        const lines = data.trim().split('\n').slice(1);
        allRows = lines.map(l => l.split(','));
        renderTable(allRows);
      });

    document.getElementById('searchInput').addEventListener('input', e => {
      const keyword = e.target.value.toLowerCase();
      const filtered = allRows.filter(row => row.some(cell => cell.toLowerCase().includes(keyword)));
      renderTable(filtered);
    });

    function renderTable(rows) {
      const tbody = document.querySelector('#leaveTable tbody');
      tbody.innerHTML = '';
      rows.forEach(row => {
        const tr = document.createElement('tr');
        row.forEach(cell => {
          const td = document.createElement('td');
          td.textContent = cell;
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
    }

    function exportCSV() {
      const header = ['Date','Employee ID','Name','Leave Type','Reason','Status'];
      const rows = [header, ...allRows];
      const csv = rows.map(r => r.join(',')).join('\n');
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'staff-leaves.csv';
      link.click();
    }
  </script></body>
</html>
