<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Coordinator • School PWA</title>
  <script>
    (function(){var t=localStorage.getItem('theme')||new URLSearchParams(location.search).get('theme')||'dark';
      document.documentElement.classList.add(t);
      document.addEventListener('DOMContentLoaded',()=>document.body.classList.add(t));})();
  </script>
  <link rel="preload" href="styles.css?v=2025-08-15-2" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="styles.css?v=2025-08-15-2"></noscript>
</head>
<body>
  <div class="wrapper">
    <section class="accent-teal">
      <div class="glass header">
        <div class="row between center">
          <div>
            <div class="h1">Coordinator Panel</div>
            <div class="text-dim">Manage timetable and broadcast</div>
          </div>
          <div class="row gap-8">
            <a class="chip" href="index.html">PIN</a>
            <button class="btn" onclick="toggleTheme()">Theme</button>
          </div>
        </div>
        <div class="tabs mt-12">
          <button class="tab chip chip-indigo" data-tab="setup" aria-selected="true">Class Setup</button>
          <button class="tab chip chip-blue"   data-tab="timetable">Timetable</button>
          <button class="tab chip chip-pink"   data-tab="broadcast">Broadcast</button>
          <button class="tab chip chip-teal"   data-tab="data">Data</button>
        </div>
      </div>
    </section>

    <section class="accent-teal">
      <!-- Setup -->
      <div class="glass mt-12 tabpanel" id="panel-setup">
        <div class="h2">Choose Class</div>
        <div class="grid mt-10">
          <input class="input" id="cClass" placeholder="Class e.g., 5">
          <input class="input" id="cSec"   placeholder="Section e.g., A">
          <button class="btn" id="cSave">Save Meta</button>
        </div>
      </div>

      <!-- Timetable -->
      <div class="glass mt-12 tabpanel hidden" id="panel-timetable">
        <div class="h2">Add / Replace Period</div>
        <div class="grid mt-10">
          <select class="input" id="ttDay">
            <option>Mon</option><option>Tue</option><option>Wed</option>
            <option>Thu</option><option>Fri</option><option>Sat</option>
          </select>
          <input class="input" id="ttPeriod" placeholder="Period # 1–12">
          <input class="input" id="ttSubject" placeholder="Subject">
          <input class="input" id="ttTeacher" placeholder="Teacher name">
          <input class="input" id="ttRoom" placeholder="Room (optional)">
          <button class="btn" id="ttAdd">Add / Update</button>
        </div>
        <div class="h3 mt-16">Class Timetable</div>
        <div id="ttList" class="list mt-8 text-dim">No entries yet.</div>
        <div class="row gap-8 mt-10">
          <button class="btn" id="ttExport">Export CSV</button>
          <button class="btn btn-danger" id="ttClear">Clear Class Timetable</button>
        </div>
      </div>

      <!-- Broadcast -->
      <div class="glass mt-12 tabpanel hidden" id="panel-broadcast">
        <div class="h2">Broadcast to Parents</div>
        <div class="grid mt-10">
          <textarea class="input" id="bMsg" rows="3" placeholder="Message..."></textarea>
          <button class="btn" id="bSend">Send</button>
        </div>
        <div class="h3 mt-16">Sent</div>
        <div id="bList" class="list mt-8 text-dim">No broadcasts.</div>
      </div>

      <!-- Data -->
      <div class="glass mt-12 tabpanel hidden" id="panel-data">
        <div class="h2">Data Tools</div>
        <p class="text-dim">Local-only demo tools.</p>
        <div class="row wrap gap-8 mt-10">
          <button class="btn" id="bk">Backup (JSON)</button>
          <label class="btn">
            <input type="file" id="rs" hidden>
            <span>Restore</span>
          </label>
        </div>
      </div>
    </section>
  </div>

  <script>
    function toggleTheme(){var c=document.documentElement.classList.contains('dark')?'dark':'light';
      var n=c==='dark'?'light':'dark';
      document.documentElement.classList.replace(c,n);document.body.classList.replace(c,n);
      localStorage.setItem('theme',n);}
    document.querySelectorAll('.tab').forEach(b=>b.addEventListener('click',()=>{
      document.querySelectorAll('.tab').forEach(x=>x.setAttribute('aria-selected','false'));
      b.setAttribute('aria-selected','true');
      const k=b.dataset.tab;
      document.querySelectorAll('.tabpanel').forEach(p=>p.classList.add('hidden'));
      document.getElementById('panel-'+k).classList.remove('hidden');
    }));
    // demo actions
    const ttList=document.getElementById('ttList'); const rows=[];
    document.getElementById('ttAdd').onclick=function(){
      const r={day:ttDay.value,period:ttPeriod.value,sub:ttSubject.value,teacher:ttTeacher.value,room:ttRoom.value};
      rows.push(r); renderTT();
    };
    document.getElementById('ttClear').onclick=function(){rows.length=0; renderTT();};
    function renderTT(){
      if(!rows.length){ttList.textContent='No entries yet.'; ttList.classList.add('text-dim'); return;}
      ttList.classList.remove('text-dim');
      ttList.innerHTML=rows.map((r,i)=>`<div class="item"><b>${i+1}.</b> ${r.day} · <b>${r.period}</b> · ${r.sub} — ${r.teacher} <span class="text-dim">${r.room||''}</span></div>`).join('');
    }
    document.getElementById('bSend').onclick=function(){
      const m=(bMsg.value||'').trim(); if(!m) return;
      const li=document.getElementById('bList');
      const row=document.createElement('div'); row.className='item'; row.textContent=m;
      li.appendChild(row); li.classList.remove('text-dim'); bMsg.value='';
    };
  </script>

  <script type="module" src="ui.js?v=2025-08-15-2"></script>
</body>
</html>
