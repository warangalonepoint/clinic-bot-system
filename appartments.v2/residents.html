<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Apartments â€¢ Residents</title>
<link rel="stylesheet" href="./styles.css">
<meta name="theme-color" content="#111"/>
</head>
<body class="bg">
<button class="logout" onclick="sessionStorage.clear();location.href='./index.html'">Logout</button>

<main class="wrap">
  <!-- HERO -->
  <div class="card hero">
    <img class="banner" src="./assets/apartments_banner.png" alt="Apartments">
    <div class="hero-overlay">
      <img class="logo" src="./assets/logo.png" onerror="this.style.display='none'">
      <div class="hero-title" data-i18n="residents_title">Residents</div>
      <div class="chips">
        <button class="chip round" id="themeChip">ðŸŒ™</button>
        <button class="chip round" data-lang="en">EN</button>
        <button class="chip round" data-lang="te">TE</button>
      </div>
    </div>
  </div>

  <!-- NAV TABS -->
  <div class="card mt">
    <div class="tabs" id="tabs">
      <button class="tab" data-tab="dash" data-i18n="dashboard">Dashboard</button>
      <button class="tab" data-tab="res" data-i18n="residents_title">Residents</button>
      <button class="tab" data-tab="guard" data-i18n="guards_title">Guards</button>
      <button class="tab" data-tab="compl" data-i18n="complaints_title">Complaints</button>
      <button class="tab" data-tab="notices" data-i18n="notices_title">Notices</button>
      <button class="tab" data-tab="log" data-i18n="log_title">Visitor Log</button>
      <button class="tab" data-tab="pre" data-i18n="preapprove_title">Pre-Approve a Visitor</button>
    </div>
  </div>

  <!-- PANELS (YOUR EXISTING SECTIONS GO INSIDE EACH) -->
  <section class="card mt tabpanel" data-tab="res">
    <h2 class="h2" data-i18n="residents_title">Residents</h2>
    <div class="grid2">
      <label data-i18n="flat_number">Flat Number<input id="r_flat" class="in"></label>
      <label data-i18n="name">Name<input id="r_name" class="in"></label>
      <label data-i18n="phone">Phone<input id="r_phone" class="in"></label>
      <label data-i18n="block">Block<input id="r_block" class="in"></label>
    </div>
    <div class="row mt8">
      <button class="btn" id="r_save" data-i18n="save">Save</button>
    </div>
    <div class="muted mt8" data-i18n="welcome">Welcome</div>
  </section>

  <!-- Example extra panels. Keep (or replace) with your existing content -->
  <section class="card mt tabpanel" data-tab="dash">
    <h2 class="h2" data-i18n="dashboard">Dashboard</h2>
    <div class="row wraptags">
      <span class="pill" data-i18n="visitors_today">Visitors Today:</span>
      <span class="pill" data-i18n="deliveries_today">Deliveries Today:</span>
      <span class="pill" data-i18n="open_complaints">Open Complaints:</span>
    </div>
  </section>

  <section class="card mt tabpanel" data-tab="guard">
    <h2 class="h2" data-i18n="guards_title">Guards</h2>
    <div class="muted">Link to guard console and guidance.</div>
  </section>

  <section class="card mt tabpanel" data-tab="compl">
    <h2 class="h2" data-i18n="complaints_title">Complaints</h2>
    <div class="muted">Your existing complaints board lives here.</div>
  </section>

  <section class="card mt tabpanel" data-tab="notices">
    <h2 class="h2" data-i18n="notices_title">Notices</h2>
    <div class="muted">Your existing notices UI here.</div>
  </section>

  <section class="card mt tabpanel" data-tab="log">
    <h2 class="h2" data-i18n="log_title">Visitor Log</h2>
    <div class="muted">Your existing visitor log table here.</div>
  </section>

  <section class="card mt tabpanel" data-tab="pre">
    <h2 class="h2" data-i18n="preapprove_title">Pre-Approve a Visitor</h2>
    <div class="muted">Your existing pre-approval form here.</div>
  </section>
</main>

<script src="./lang.js"></script>
<script>
/* ===== shared UI: theme + language + tabs ===== */
const LS_THEME='apt_theme', LS_LANG='apt_lang', PAGE_KEY='residents';

function applyTheme(){
  const t = localStorage.getItem(LS_THEME)||'light';
  document.documentElement.setAttribute('data-theme', t);
  document.getElementById('themeChip').textContent = t==='light' ? 'ðŸŒ™' : 'ðŸŒž';
}
function toggleTheme(){
  const next = (localStorage.getItem(LS_THEME)||'light')==='light' ? 'dark':'light';
  localStorage.setItem(LS_THEME,next); applyTheme();
}
function applyLang(){
  const lang = localStorage.getItem(LS_LANG)||'en';
  // lang.js is expected to expose window.t(key)
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const k = el.getAttribute('data-i18n');
    if(window.t){ el.firstChild.nodeValue = t(k); }
  });
}

function setupChips(){
  document.getElementById('themeChip').onclick=toggleTheme;
  document.querySelectorAll('[data-lang]').forEach(b=>{
    b.addEventListener('click', ()=>{
      localStorage.setItem(LS_LANG, b.dataset.lang);
      location.reload();
    });
  });
}

function setupTabs(){
  const tabs = document.querySelectorAll('.tab');
  const panels = document.querySelectorAll('.tabpanel');
  const LS_TAB = PAGE_KEY+'_tab';
  function show(tab){
    tabs.forEach(b=>b.classList.toggle('active', b.dataset.tab===tab));
    panels.forEach(p=>p.style.display = p.dataset.tab===tab ? 'block':'none');
    localStorage.setItem(LS_TAB, tab);
  }
  tabs.forEach(b=> b.addEventListener('click', ()=>show(b.dataset.tab)));
  const start = localStorage.getItem(LS_TAB) || tabs[0]?.dataset.tab || '';
  show(start);
}

applyTheme(); setupChips(); applyLang(); setupTabs();
</script>
</body>
</html>
